============================= test session starts =============================
platform win32 -- Python 3.13.5, pytest-9.0.1, pluggy-1.6.0
rootdir: C:\Users\pault\Documents\3. AI and Machine Learning\2. Deep Learning\1c. App\Projects\agents-backend
configfile: pyproject.toml
plugins: anyio-4.12.0, Faker-25.0.0, langsmith-0.4.23, libtmux-0.53.0, asyncio-1.3.0, cov-7.0.0, django-4.5.2, mock-3.11.1, postgresql-7.0.2, sugar-1.1.1, xdist-3.3.1
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collected 8 items

backend\tests\live\billing\integration\test_endpoints.py EEE             [ 37%]
backend\tests\live\billing\integration\test_webhooks.py EEE              [ 75%]
backend\tests\live\billing\scenarios\test_user_scenarios.py EE           [100%]

=================================== ERRORS ====================================
__________________ ERROR at setup of test_get_account_state ___________________

self = <Coroutine test_get_account_state>

    def setup(self) -> None:
        runner_fixture_id = f"_{self._loop_scope}_scoped_runner"
        if runner_fixture_id not in self.fixturenames:
            self.fixturenames.append(runner_fixture_id)
>       return super().setup()
               ^^^^^^^^^^^^^^^

C:\Users\pault\AppData\Roaming\Python\Python313\site-packages\pytest_asyncio\plugin.py:458: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\pault\AppData\Roaming\Python\Python313\site-packages\pytest_asyncio\plugin.py:728: in pytest_fixture_setup
    return (yield)
            ^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    @pytest.fixture(scope="session", autouse=True)
    def mock_heavy_services():
        """Mock heavy services initialization."""
>       with patch("backend.src.services.sandbox_service.sandbox_service.initialize", new_callable=MagicMock) as mock_sandbox_init, \
                                                                                                   ^^^^^^^^^
             patch("backend.src.graph.checkpointer.checkpointer_manager.initialize", new_callable=MagicMock) as mock_checkpoint_init, \
             patch("backend.src.services.sandbox_service.sandbox_service.shutdown", new_callable=MagicMock), \
             patch("backend.src.graph.checkpointer.checkpointer_manager.shutdown", new_callable=MagicMock):
E            NameError: name 'MagicMock' is not defined

backend\tests\live\billing\conftest.py:15: NameError
___________________ ERROR at setup of test_get_transactions ___________________

self = <Coroutine test_get_transactions>

    def setup(self) -> None:
        runner_fixture_id = f"_{self._loop_scope}_scoped_runner"
        if runner_fixture_id not in self.fixturenames:
            self.fixturenames.append(runner_fixture_id)
>       return super().setup()
               ^^^^^^^^^^^^^^^

C:\Users\pault\AppData\Roaming\Python\Python313\site-packages\pytest_asyncio\plugin.py:458: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    @pytest.fixture(scope="session", autouse=True)
    def mock_heavy_services():
        """Mock heavy services initialization."""
>       with patch("backend.src.services.sandbox_service.sandbox_service.initialize", new_callable=MagicMock) as mock_sandbox_init, \
                                                                                                   ^^^^^^^^^
             patch("backend.src.graph.checkpointer.checkpointer_manager.initialize", new_callable=MagicMock) as mock_checkpoint_init, \
             patch("backend.src.services.sandbox_service.sandbox_service.shutdown", new_callable=MagicMock), \
             patch("backend.src.graph.checkpointer.checkpointer_manager.shutdown", new_callable=MagicMock):
E            NameError: name 'MagicMock' is not defined

backend\tests\live\billing\conftest.py:15: NameError
_______________ ERROR at setup of test_create_checkout_session ________________

self = <Coroutine test_create_checkout_session>

    def setup(self) -> None:
        runner_fixture_id = f"_{self._loop_scope}_scoped_runner"
        if runner_fixture_id not in self.fixturenames:
            self.fixturenames.append(runner_fixture_id)
>       return super().setup()
               ^^^^^^^^^^^^^^^

C:\Users\pault\AppData\Roaming\Python\Python313\site-packages\pytest_asyncio\plugin.py:458: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    @pytest.fixture(scope="session", autouse=True)
    def mock_heavy_services():
        """Mock heavy services initialization."""
>       with patch("backend.src.services.sandbox_service.sandbox_service.initialize", new_callable=MagicMock) as mock_sandbox_init, \
                                                                                                   ^^^^^^^^^
             patch("backend.src.graph.checkpointer.checkpointer_manager.initialize", new_callable=MagicMock) as mock_checkpoint_init, \
             patch("backend.src.services.sandbox_service.sandbox_service.shutdown", new_callable=MagicMock), \
             patch("backend.src.graph.checkpointer.checkpointer_manager.shutdown", new_callable=MagicMock):
E            NameError: name 'MagicMock' is not defined

backend\tests\live\billing\conftest.py:15: NameError
______________ ERROR at setup of test_webhook_missing_signature _______________

self = <Coroutine test_webhook_missing_signature>

    def setup(self) -> None:
        runner_fixture_id = f"_{self._loop_scope}_scoped_runner"
        if runner_fixture_id not in self.fixturenames:
            self.fixturenames.append(runner_fixture_id)
>       return super().setup()
               ^^^^^^^^^^^^^^^

C:\Users\pault\AppData\Roaming\Python\Python313\site-packages\pytest_asyncio\plugin.py:458: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    @pytest.fixture(scope="session", autouse=True)
    def mock_heavy_services():
        """Mock heavy services initialization."""
>       with patch("backend.src.services.sandbox_service.sandbox_service.initialize", new_callable=MagicMock) as mock_sandbox_init, \
                                                                                                   ^^^^^^^^^
             patch("backend.src.graph.checkpointer.checkpointer_manager.initialize", new_callable=MagicMock) as mock_checkpoint_init, \
             patch("backend.src.services.sandbox_service.sandbox_service.shutdown", new_callable=MagicMock), \
             patch("backend.src.graph.checkpointer.checkpointer_manager.shutdown", new_callable=MagicMock):
E            NameError: name 'MagicMock' is not defined

backend\tests\live\billing\conftest.py:15: NameError
______________ ERROR at setup of test_webhook_invalid_signature _______________

self = <Coroutine test_webhook_invalid_signature>

    def setup(self) -> None:
        runner_fixture_id = f"_{self._loop_scope}_scoped_runner"
        if runner_fixture_id not in self.fixturenames:
            self.fixturenames.append(runner_fixture_id)
>       return super().setup()
               ^^^^^^^^^^^^^^^

C:\Users\pault\AppData\Roaming\Python\Python313\site-packages\pytest_asyncio\plugin.py:458: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    @pytest.fixture(scope="session", autouse=True)
    def mock_heavy_services():
        """Mock heavy services initialization."""
>       with patch("backend.src.services.sandbox_service.sandbox_service.initialize", new_callable=MagicMock) as mock_sandbox_init, \
                                                                                                   ^^^^^^^^^
             patch("backend.src.graph.checkpointer.checkpointer_manager.initialize", new_callable=MagicMock) as mock_checkpoint_init, \
             patch("backend.src.services.sandbox_service.sandbox_service.shutdown", new_callable=MagicMock), \
             patch("backend.src.graph.checkpointer.checkpointer_manager.shutdown", new_callable=MagicMock):
E            NameError: name 'MagicMock' is not defined

backend\tests\live\billing\conftest.py:15: NameError
____________ ERROR at setup of test_webhook_valid_signature_mocked ____________

self = <Coroutine test_webhook_valid_signature_mocked>

    def setup(self) -> None:
        runner_fixture_id = f"_{self._loop_scope}_scoped_runner"
        if runner_fixture_id not in self.fixturenames:
            self.fixturenames.append(runner_fixture_id)
>       return super().setup()
               ^^^^^^^^^^^^^^^

C:\Users\pault\AppData\Roaming\Python\Python313\site-packages\pytest_asyncio\plugin.py:458: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    @pytest.fixture(scope="session", autouse=True)
    def mock_heavy_services():
        """Mock heavy services initialization."""
>       with patch("backend.src.services.sandbox_service.sandbox_service.initialize", new_callable=MagicMock) as mock_sandbox_init, \
                                                                                                   ^^^^^^^^^
             patch("backend.src.graph.checkpointer.checkpointer_manager.initialize", new_callable=MagicMock) as mock_checkpoint_init, \
             patch("backend.src.services.sandbox_service.sandbox_service.shutdown", new_callable=MagicMock), \
             patch("backend.src.graph.checkpointer.checkpointer_manager.shutdown", new_callable=MagicMock):
E            NameError: name 'MagicMock' is not defined

backend\tests\live\billing\conftest.py:15: NameError
_____________ ERROR at setup of test_scenario_free_to_pro_upgrade _____________

self = <Coroutine test_scenario_free_to_pro_upgrade>

    def setup(self) -> None:
        runner_fixture_id = f"_{self._loop_scope}_scoped_runner"
        if runner_fixture_id not in self.fixturenames:
            self.fixturenames.append(runner_fixture_id)
>       return super().setup()
               ^^^^^^^^^^^^^^^

C:\Users\pault\AppData\Roaming\Python\Python313\site-packages\pytest_asyncio\plugin.py:458: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    @pytest.fixture(scope="session", autouse=True)
    def mock_heavy_services():
        """Mock heavy services initialization."""
>       with patch("backend.src.services.sandbox_service.sandbox_service.initialize", new_callable=MagicMock) as mock_sandbox_init, \
                                                                                                   ^^^^^^^^^
             patch("backend.src.graph.checkpointer.checkpointer_manager.initialize", new_callable=MagicMock) as mock_checkpoint_init, \
             patch("backend.src.services.sandbox_service.sandbox_service.shutdown", new_callable=MagicMock), \
             patch("backend.src.graph.checkpointer.checkpointer_manager.shutdown", new_callable=MagicMock):
E            NameError: name 'MagicMock' is not defined

backend\tests\live\billing\conftest.py:15: NameError
_______________ ERROR at setup of test_scenario_credit_purchase _______________

self = <Coroutine test_scenario_credit_purchase>

    def setup(self) -> None:
        runner_fixture_id = f"_{self._loop_scope}_scoped_runner"
        if runner_fixture_id not in self.fixturenames:
            self.fixturenames.append(runner_fixture_id)
>       return super().setup()
               ^^^^^^^^^^^^^^^

C:\Users\pault\AppData\Roaming\Python\Python313\site-packages\pytest_asyncio\plugin.py:458: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

    @pytest.fixture(scope="session", autouse=True)
    def mock_heavy_services():
        """Mock heavy services initialization."""
>       with patch("backend.src.services.sandbox_service.sandbox_service.initialize", new_callable=MagicMock) as mock_sandbox_init, \
                                                                                                   ^^^^^^^^^
             patch("backend.src.graph.checkpointer.checkpointer_manager.initialize", new_callable=MagicMock) as mock_checkpoint_init, \
             patch("backend.src.services.sandbox_service.sandbox_service.shutdown", new_callable=MagicMock), \
             patch("backend.src.graph.checkpointer.checkpointer_manager.shutdown", new_callable=MagicMock):
E            NameError: name 'MagicMock' is not defined

backend\tests\live\billing\conftest.py:15: NameError
=========================== short test summary info ===========================
ERROR backend/tests/live/billing/integration/test_endpoints.py::test_get_account_state
ERROR backend/tests/live/billing/integration/test_endpoints.py::test_get_transactions
ERROR backend/tests/live/billing/integration/test_endpoints.py::test_create_checkout_session
ERROR backend/tests/live/billing/integration/test_webhooks.py::test_webhook_missing_signature
ERROR backend/tests/live/billing/integration/test_webhooks.py::test_webhook_invalid_signature
ERROR backend/tests/live/billing/integration/test_webhooks.py::test_webhook_valid_signature_mocked
ERROR backend/tests/live/billing/scenarios/test_user_scenarios.py::test_scenario_free_to_pro_upgrade
ERROR backend/tests/live/billing/scenarios/test_user_scenarios.py::test_scenario_credit_purchase
============================== 8 errors in 2.94s ==============================
